<html>
    <head>
        <meta charset='utf-8'>
        <title>jquery常见效果</title>
        
<script type="text/javascript" src="jquery-3.1.1/jquery-3.1.1.min.js"></script>
        <link rel="stylesheet" type="text/css" href="css/base.css">
        <link rel="stylesheet" type="text/css" href="css/index1.css">
    </head>
    <body>
        <div class='container'>
            <div id='header'>
                <h3>jquery的常见特效---图片懒加载</h3>
                <p>先加载可视窗口区域的图片，当用户向下拖动滚动条时再继续加载后面的图片</p>
                <ul class='clearfix'>
                    <li><a href='index.html'>懒加载</a></li>
                    <li><a href='index2.html'>tab切换</a></li>
                    <li><a href='index3.html'>回到顶部</a></li>
                    <li><a href="album/index.html" target="_blank">简单的相册</a></li>
                    <li><a href="slider/slider.html" target="_blank">轮播</a></li>
                    <li><a href="form/form.html" target="_blank">菜单栏</a></li>
                    <li><a href="calculator/calculator.html" target="_blank">简单的计算机</a></li>
                </ul>
            </div>
            <div class='view'>
                <ul class='lazyLoading clearfix'>
                    <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                     <li>
                        <a href='#'>
                            <img src='imgs/1.jpg' data-src='imgs/cat2.jpg'>
                        </a>
                    </li>
                </ul>
            </div>
            

        </div>
      
        <script>
           var lazyLoading={
                init:function($imgs) {
                    this.$ct=$('.lazyLoading');
                    this.items=this.$ct.children();
                    this.bind();
                    this.$target=$imgs;
                    console.log(this.$target);
                },
                bind:function() {       //监听窗口滚动事件，检查元素是否在可视范围内
                    var $cur=this;  //this 代表当前对象
                    $(window).on('scroll',function() {   //监听滚动事件
                      $cur.checkShow();
                    });
                },
                checkShow:function() {     //检查元素是否在可视范围
                    var $cur=this;
                   $cur.$target.each(function() { //遍历每一个元素
                        var $cur1=$(this);
                        if($cur.isShow($cur1)) {  //判断是否已加载
                           setTimeout(function() {
                                $cur.showImg($cur1)
                           },200)  //设置时间更好看出效果
                        }
                   });
                },
                isShow:function($el) {
                    var $cur=this;
                    var winH=$(window).height(); //获取窗口高度
                    var offsetH=$el.offset().top; //获取元素距离窗口顶部偏移高度
                    var scrollT=$(window).scrollTop();//获取窗口滚动高度
                    if(offsetH<winH+scrollT) {
                        return true; //在可视范围
                    }else {
                        return false; //不在可视范围
                    }
                },
                showImg:function($el) {
                    var $cur=this;
                    $el.attr('src',$el.attr('data-src')); //元素显示的时候把之前的默认照片替换成data-src里的照片
                }
                
           }
           lazyLoading.init($('.lazyLoading li img'));
        </script>
    </body>
</html>